<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Iniciar Sessão - Voluntariados</title>
    <style>
        body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,Arial;margin:0;background:#f9fdf8}
        .box{max-width:520px;margin:80px auto;background:#fff;padding:28px;border-radius:12px;border:1px solid #e8f5e1}
        label{display:block;margin-bottom:6px;font-weight:600}
        input,select{width:100%;padding:10px;border-radius:8px;border:1px solid #e8f5e1;margin-bottom:12px}
        button{background:#10b981;color:#fff;padding:10px 14px;border-radius:8px;border:none;cursor:pointer}
    </style>
</head>
<body>
    <div class="box">
        <h2>Iniciar Sessão / Entrar</h2>
        <p style="color:#6b7280;margin-bottom:12px">Escolha o tipo de conta e introduza os seus dados. Pode navegar sem conta depois de fechar esta janela.</p>

        <label for="role">Tipo de Conta</label>
        <div style="display:flex;gap:8px;margin-bottom:12px">
            <button id="roleVolunteer" class="role-btn active">Voluntário</button>
            <button id="roleOrg" class="role-btn">Organização</button>
        </div>

        <form id="signinForm">
            <div id="volunteerFields">
                <label for="volEmail">Email</label>
                <input id="volEmail" type="email" placeholder="seu@exemplo.com" required />

                <label for="volPassword">Senha</label>
                <input id="volPassword" type="password" placeholder="********" required />

                <label for="volPhone">Telefone</label>
                <input id="volPhone" type="tel" placeholder="(00) 90000-0000" />
            </div>

            <div id="orgFields" style="display:none">
                <label for="orgName">Nome da Organização</label>
                <input id="orgName" placeholder="Nome da organização" />

                <label for="orgEmail">Email</label>
                <input id="orgEmail" type="email" placeholder="contato@org.pt" />

                <label for="orgPassword">Senha</label>
                <input id="orgPassword" type="password" placeholder="********" />

                <label for="orgPhone">Telefone</label>
                <input id="orgPhone" type="tel" placeholder="(00) 90000-0000" />
            </div>

            <div style="display:flex;gap:10px;margin-top:10px">
                <button type="submit" id="submitBtn">Entrar</button>
                <a href="index.html" style="display:inline-flex;align-items:center;justify-content:center;padding:10px 14px;border-radius:8px;border:1px solid #e8f5e1;color:#6b7280;background:#fff;text-decoration:none">Voltar</a>
            </div>
        </form>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="js/bootstrap-init.js"></script>
    <script src="js/site.js"></script>
    <script>
        (function(){
            const roleVolunteer = document.getElementById('roleVolunteer');
            const roleOrg = document.getElementById('roleOrg');
            const volFields = document.getElementById('volunteerFields');
            const orgFields = document.getElementById('orgFields');

            function setRole(role){
                if(role === 'organization'){
                    roleOrg.classList.add('active'); roleVolunteer.classList.remove('active');
                    volFields.style.display = 'none'; orgFields.style.display = 'block';
                } else {
                    roleVolunteer.classList.add('active'); roleOrg.classList.remove('active');
                    volFields.style.display = 'block'; orgFields.style.display = 'none';
                }
            }

            roleVolunteer.addEventListener('click', function(e){ e.preventDefault(); setRole('volunteer'); });
            roleOrg.addEventListener('click', function(e){ e.preventDefault(); setRole('organization'); });

            document.getElementById('signinForm').addEventListener('submit', function(e){
                e.preventDefault();
                const isOrg = orgFields.style.display !== 'none';
                try{
                    if(isOrg){
                        const name = document.getElementById('orgName').value.trim() || 'Minha Organização';
                        const email = document.getElementById('orgEmail').value.trim();
                        const password = document.getElementById('orgPassword').value;
                        const phone = document.getElementById('orgPhone').value.trim();
                        const orgData = { name, email, phone, password };
                        localStorage.setItem('orgData', JSON.stringify(orgData));
                        localStorage.setItem('userRole', 'organization');
                        localStorage.setItem('userName', name);
                        window.location.href = 'dashboard.html';
                    } else {
                        const email = document.getElementById('volEmail').value.trim();
                        const password = document.getElementById('volPassword').value;
                        const phone = document.getElementById('volPhone').value.trim();
                        const volData = { email, phone };
                        localStorage.setItem('volunteerData', JSON.stringify(volData));
                        localStorage.setItem('userRole', 'volunteer');
                        localStorage.setItem('userName', email || 'Voluntário');
                        window.location.href = 'index.html';
                    }
                } catch (err){
                    console.error(err);
                    alert('Ocorreu um erro. Tente novamente.');
                }
            });
        })();
    </script>
</body>
</html>